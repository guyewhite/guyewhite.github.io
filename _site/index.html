<!DOCTYPE html>
<html lang="en-us">

  <head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FGRFCNF8RC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FGRFCNF8RC');
</script>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      gelvinwhite &middot; musical coding. generative music. algorithmic composition
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link href="https://fonts.googleapis.com/css?family=East+Sea+Dokdo&display=swap" rel="stylesheet">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">
  <script src="https://kit.fontawesome.com/966f470220.js" crossorigin="anonymous"></script>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    // displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    // Fix <code> tags after MathJax finishes running. This is a
    // hack to overcome a shortcoming of Markdown. Discussion at
    // https://github.com/mojombo/jekyll/issues/199
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  // Autonumbering by mathjax
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>

</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <div class="author-image">
        <a href="/">
        <img src="/assets/gelvinwhite.png" alt="Author Image" class="author-image">
        </a>
      </div>
      <h1>
        <a href="/">
          gelvinwhite
        </a>
      </h1>
      <p class="lead">musical coding. generative music. algorithmic composition</p>
    </div>

    <nav class="sidebar-nav">
     <a class="sidebar-nav-item active" href="/">Home</a>

     <!-- Manual set order -->
     <a class="sidebar-nav-item active" href="/categories">Categories</a>
     <!-- <a class="sidebar-nav-item active" href="/projects">Projects</a> -->
     <a class="sidebar-nav-item active" href="/about">About</a>
     <a class="sidebar-nav-item active" href="/resources">Useful Resources</a>

     
<div id="social-media">
    
    
        
        
            <a href="https://www.instagram.com/gelvinwhite" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
        
    
        
        
            <a href="https://www.github.com/guyewhite" title="Github"><i class="fa-brands fa-github"></i></a>
        
    
</div>



   </nav>

   <p>Copyright &copy; 2022 THI. All rights reserved. Operated by THI.</p>
   <p><a href="/terms">Terms of Use</a> | <a href="/privacy">Privacy</a></p>
 </div>
</div>


    <div class="content container">
      <div id="archives">

  <div class="archive-group">
    
    <div class="category-name"><div id="#KONTAKT"></div></div>
    <p></p>

    <div class="category-name">
        <h2>KONTAKT</h2>
    </div>
    <a name="KONTAKT"></a>
    

    
    <article class="recent-posts">
      <h4><a href="//kontakt/2022/09/30/how-to-create-a-kontakt-7-instrument/">How to Create a Kontakt 7 Instrument (Part 1) - Hello World! </a></h4>
    </article>

    
    <article class="recent-posts">
      <h4><a href="//kontakt/2022/10/01/how-to-create-a-kontakt-7-instrument-part-2/">How to Create a Kontakt 7 Instrument (Part 2) - Push It! </a></h4>
    </article>

    
    <article class="recent-posts">
      <h4><a href="//kontakt/2022/10/02/how-to-create-a-kontakt-7-instrument-part-3/">How to Create a Kontakt 7 Instrument (Part 3) - Switcheroo </a></h4>
    </article>

    
    <article class="recent-posts">
      <h4><a href="//kontakt/2022/10/14/how-to-create-a-kontakt-7-instrument-part-4/">How to Create a Kontakt 7 Instrument (Part 4) - Midi Scale </a></h4>
    </article>

    
    <hr></hr>
  </div>

</div>

<!--
<div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/kontakt/2022/10/14/how-to-create-a-kontakt-7-instrument-part-4/">
        How to Create a Kontakt 7 Instrument (Part 4) - Midi Scale
      </a>
    </h1>

    <span class="post-date">14 Oct 2022</span>

    <p>Welcome to the fourth installment of my multi-part series about how to engage in the beautiful pursuit of building your own instruments, effects, and plugins in the Kontakt Script Processor (KSP).</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>This tutorial continues from the <a href="https://gelvinwhite.com/kontakt/2022/10/02/how-to-create-a-kontakt-7-instrument-part-3/">third installment</a> of this multi-part series. So, if you have not followed the instructions in our previous installments, best to backtrack and complete those steps. Further, this tutorial requires a full version of Kontakt. Likely, Kontakt 5 or later is fine. However, screenshots in this tutorial are of Kontakt 7.</p>

<h2 id="getting-started">Getting Started</h2>

<p>Continuing from where we left off, please ensure that the following starter code is in place in the scripting window:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```
{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $run that is tied to a button. Set that button to off }
  declare ui_switch $run
  $run := 0
  message("Ready to run")

  {declare another button called $option1 that is tied to a button. The initial value is set to on}
  declare ui_switch $option1
  $option1 := 1
  declare $option1Id
  $option1Id := get_ui_id($option1)
  set_control_par_str($option1Id, $CONTROL_PAR_TEXT, "A")

  {declare another button called $option2 that is tied to a button. The initial value is set to off}
  declare ui_switch $option2
  $option2 := 0
  declare $option2Id
  $option2Id := get_ui_id($option2)
  set_control_par_str($option2Id, $CONTROL_PAR_TEXT, "B")

  {declare another button called $option3 that is tied to a button. The initial value is set to off}
  declare ui_switch $option3
  $option3 := 0
  declare $option3Id
  $option3Id := get_ui_id($option3)
  set_control_par_str($option3Id, $CONTROL_PAR_TEXT, "C")

  {set initial instrument state value}
  declare @state
  @state := "A"

end on

{creates a function that resets the values of run}
function resetRun()

  $run := 0
  message("Ready to run")

end function

{this runs when the ui_control called $switch is changed}
on ui_control($run)

  if($run = 1)
    message("Running " &amp; @state)
  else
    message("Ready to run")
  end if
end on

{this runs when the ui_control called $option1 is changed}
on ui_control ($option1)

  $option1 := 1

  {toggle the other buttons off}
  $option2 := 0
  $option3 := 0

  {reset the run button}
  call resetRun()

  @state := "A"

end on

{this runs when the ui_control called $option2 is changed}
on ui_control ($option2)

  $option2 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option3 := 0

  {reset the run button}
  call resetRun()

  @state := "B"

end on

{this runs when the ui_control called $option3 is changed}
on ui_control ($option3)

  $option3 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option2 := 0

  {reset the run button}
  call resetRun()

  @state := "C"

end on
```
</code></pre></div></div>

<p>Ensure that the script functions by clicking <code class="language-plaintext highlighter-rouge">Apply</code>. Upon clicking <code class="language-plaintext highlighter-rouge">Apply</code> followed by clicking <code class="language-plaintext highlighter-rouge">C</code>, and <code class="language-plaintext highlighter-rouge">run</code> you should see <code class="language-plaintext highlighter-rouge">Running C</code> appearing in the status bar / console at the bottom of the screen.</p>

<h3 id="step-one---building-scales">Step One - Building Scales</h3>

<ul>
  <li>Generally speaking, <em>arrays</em> are contiguous, back-to-back areas of memory where a series of numbers, letters, or other data types are stored.</li>
  <li>KSP offers array types for integers, real numbers, and strings.</li>
  <li>
    <p>For example, consider the following <em>integer array</em>:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this is an integer array}
declare %myArray[4] := (0,1,2,3)
</code></pre></div>    </div>
    <p>Notice that the <code class="language-plaintext highlighter-rouge">declare</code> statement creates an array of type integer, signified by the <code class="language-plaintext highlighter-rouge">%</code> symbol. The number of elements allowed in this array is <code class="language-plaintext highlighter-rouge">4</code>. Then, the values for each of those four locations are assigned. So, the <em>zeroth</em> spot contains the value <code class="language-plaintext highlighter-rouge">0</code>. <code class="language-plaintext highlighter-rouge">myArray</code> of <code class="language-plaintext highlighter-rouge">1</code> (the second location of the array) contains an integer <code class="language-plaintext highlighter-rouge">1</code>. <code class="language-plaintext highlighter-rouge">myArray</code> of <code class="language-plaintext highlighter-rouge">2</code> (the third location of the array) contains an integer <code class="language-plaintext highlighter-rouge">2</code>. The last location of <code class="language-plaintext highlighter-rouge">myArray</code> is <code class="language-plaintext highlighter-rouge">myArray</code> of <code class="language-plaintext highlighter-rouge">3</code>, which contains a <code class="language-plaintext highlighter-rouge">3</code>.</p>
  </li>
  <li>
    <p>Arrays are <em>zero-indexed</em> in that we start counting the locations in the array starting at zero. This comports with most programming languages that count starting at zero. For example, consider this second array:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this is another integer array}
declare %myOtherArray[3] := (52,65,44)
message(%myOtherArray[0])
</code></pre></div>    </div>
    <p>Notice that <code class="language-plaintext highlighter-rouge">myOtherArray</code> can hold three integers. The first location, <code class="language-plaintext highlighter-rouge">%myOtherArray[0]</code> holds the integer value <code class="language-plaintext highlighter-rouge">52</code>. This code will <code class="language-plaintext highlighter-rouge">message</code> that a value to the console. What would happen if you modified your <code class="language-plaintext highlighter-rouge">message</code> statement to <code class="language-plaintext highlighter-rouge">message(%myOtherArray[2])</code>? If you guessed that <code class="language-plaintext highlighter-rouge">44</code> would be displayed in the console, you are correct!</p>
  </li>
  <li>
    <p>Arrays are very useful for holding collections of values. For example, let’s add the following to the bottom of your <code class="language-plaintext highlighter-rouge">on init</code> function in your starter code:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{c major scale in midi notes}
declare %cMajorScale[8] := (60,62,64,65,67,69,71,72)
</code></pre></div>    </div>
    <p>Notice that this array of integers has eight locations where one could store values. Then, eight values are assigned to these positions. The zeroth value is <code class="language-plaintext highlighter-rouge">60</code>. The last value in the array is <code class="language-plaintext highlighter-rouge">72</code>.</p>
  </li>
  <li>Midi notes are assigned specific integer values by industry standards. <code class="language-plaintext highlighter-rouge">60</code> is designated as a middle C (C3). <code class="language-plaintext highlighter-rouge">62</code> is designated as the D above middle C (D3). Accordingly, the array you just added to your code essentially holds the values of the C major scale. You can obtain a midi note chart simply by Googling “midi note chart”.</li>
  <li>
    <p>Under the code you just added, also add the line <code class="language-plaintext highlighter-rouge">declare $count := 0</code> as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{c major scale in midi notes}
declare %cMajorScale[8] := (60,62,64,65,67,69,71,72)
declare $count := 0
</code></pre></div>    </div>
    <p>We will be using this additional <code class="language-plaintext highlighter-rouge">count</code> variable in the step to come.</p>
  </li>
  <li>After adding the above code to the end of your <code class="language-plaintext highlighter-rouge">on init</code> function, hit <code class="language-plaintext highlighter-rouge">Apply</code>. Provided that no errors appear and your program functions as it did before, you have added it correctly.</li>
</ul>

<h3 id="step-two---looping-with-while">Step Two - Looping with While</h3>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">while</code> loops will repeat a block of code as long as a condition is true. For example, consider the following code:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this loop will repeat while count is less than 8}
while ($count &lt; 7)
  {message the count to the console}
  message($count)

  {wait 1000000 microseconds or 1 second}
  wait(1000000)

  {increment the count by 1}
  inc ($count)
end while
</code></pre></div>    </div>
    <p>Notice that this will loop as long as <code class="language-plaintext highlighter-rouge">count</code> is less than <code class="language-plaintext highlighter-rouge">7</code>. First, the loop messages the current count. Then, we <code class="language-plaintext highlighter-rouge">wait</code> for <code class="language-plaintext highlighter-rouge">1000000</code> microseconds. Then, the <code class="language-plaintext highlighter-rouge">count</code> is increased by <code class="language-plaintext highlighter-rouge">1</code>. The loop will then repeat over and over again until <code class="language-plaintext highlighter-rouge">count</code> is no longer less than <code class="language-plaintext highlighter-rouge">8</code>.</p>
  </li>
  <li>
    <p>We can effectively create a function within our script that loops through each note of the <code class="language-plaintext highlighter-rouge">cMajorScale</code> array. Add the following code immediately below the end <code class="language-plaintext highlighter-rouge">on init</code> callback.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function play()

  while ($count &lt; 7)
    message("Note # " &amp; %cMajorScale[$count])
    play_note(%cMajorScale[$count],127,0,2000000)
    wait(2000000)
    inc ($count)
  end while

  $count := 0

end function
</code></pre></div>    </div>
    <p>Notice how this function, called <code class="language-plaintext highlighter-rouge">play</code>, will first enter a <code class="language-plaintext highlighter-rouge">while</code> loop. The <code class="language-plaintext highlighter-rouge">loop</code> will check to see if <code class="language-plaintext highlighter-rouge">count</code> is less than <code class="language-plaintext highlighter-rouge">8</code>. If so, it will message the console the current note being played in midi notation. Since <code class="language-plaintext highlighter-rouge">%cMajorScale[0]</code> is <code class="language-plaintext highlighter-rouge">60</code> this will cause <code class="language-plaintext highlighter-rouge">60</code> to appear in the console. Then, the next line of code engages the midi engine to play a note. In this initial case, it plays note <code class="language-plaintext highlighter-rouge">60</code> or C3. It plays it at velocity <code class="language-plaintext highlighter-rouge">127</code>, with <code class="language-plaintext highlighter-rouge">0</code> sample offset (more on that later), for length <code class="language-plaintext highlighter-rouge">2000000</code> microseconds or 2 seconds. Then, the script engine waits for <code class="language-plaintext highlighter-rouge">2000000</code> microseconds or <code class="language-plaintext highlighter-rouge">2</code> seconds. Finally, the count is increased. Next time through the loop, <code class="language-plaintext highlighter-rouge">%cMajorScale[1]</code> or <code class="language-plaintext highlighter-rouge">62</code> is played. This is a D3 note. This repeats until the scale is done. In the end, <code class="language-plaintext highlighter-rouge">count</code> is reset to <code class="language-plaintext highlighter-rouge">0</code>.</p>
  </li>
  <li>
    <p>Finally, we need to tell the script processor to run this <code class="language-plaintext highlighter-rouge">play</code> function when the <code class="language-plaintext highlighter-rouge">run</code> button is pressed. Accordingly, in the <code class="language-plaintext highlighter-rouge">on ui_control($run)</code> callback, modify its contents to be the following:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this runs when the ui_control called $run is changed}
on ui_control($run)

  call play()

  {always set the run button back to its original state}
  $run := 0
end on
</code></pre></div>    </div>
    <p>Notice that this function simply executes the <code class="language-plaintext highlighter-rouge">play</code> callback. Then, it resets itself to the <code class="language-plaintext highlighter-rouge">off</code> position.</p>
  </li>
  <li>Your program is ready to run some midi to your DAW!</li>
  <li>
    <p>As a final check, your final code should appear as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $run that is tied to a button. Set that button to off }
  declare ui_switch $run
  $run := 0
  message("Ready to run")

  {declare another button called $option1 that is tied to a button. The initial value is set to on}
  declare ui_switch $option1
  $option1 := 1
  declare $option1Id
  $option1Id := get_ui_id($option1)
  set_control_par_str($option1Id, $CONTROL_PAR_TEXT, "A")

  {declare another button called $option2 that is tied to a button. The initial value is set to off}
  declare ui_switch $option2
  $option2 := 0
  declare $option2Id
  $option2Id := get_ui_id($option2)
  set_control_par_str($option2Id, $CONTROL_PAR_TEXT, "B")

  {declare another button called $option3 that is tied to a button. The initial value is set to off}
  declare ui_switch $option3
  $option3 := 0
  declare $option3Id
  $option3Id := get_ui_id($option3)
  set_control_par_str($option3Id, $CONTROL_PAR_TEXT, "C")

  {set initial instrument state value}
  declare @state
  @state := "A"

  {c major scale in midi notes}
  declare %cMajorScale[8] := (60,62,64,65,67,69,71,72)
  declare $count := 0

end on

{creates a function that resets the values of run}
function resetRun()

  $run := 0
  message("Ready to run")

end function

function play()

  while ($count &lt; 8)
    message("Note # " &amp; %cMajorScale[$count])
    play_note(%cMajorScale[$count],127,0,2000000)
    wait(2000000)
    inc ($count)
  end while

  $count := 0

end function

{this runs when the ui_control called $run is changed}
on ui_control($run)

  call play()

  {always set the run button back to its original state}
  $run := 0
end on

{this runs when the ui_control called $option1 is changed}
on ui_control ($option1)

  $option1 := 1

  {toggle the other buttons off}
  $option2 := 0
  $option3 := 0

  {reset the run button}
  call resetRun()

  @state := "A"

end on

{this runs when the ui_control called $option2 is changed}
on ui_control ($option2)

  $option2 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option3 := 0

  {reset the run button}
  call resetRun()

  @state := "B"

end on

{this runs when the ui_control called $option3 is changed}
on ui_control ($option3)

  $option3 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option2 := 0

  {reset the run button}
  call resetRun()

  @state := "C"

end on
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="step-three---overcoming-the-curses-of-midi-routing">Step Three - Overcoming the Curses of Midi Routing</h3>

<ul>
  <li>Ironically, despite the complications that are inherent in coding, simply getting one’s DAW to recognize the MIDI data emerging from Kontakt can be the most challenging aspect of this slice of our larger project.</li>
  <li>
    <p>Kontakt’s side of things is exceptionally easy. You’ll want to head to the gear <code class="language-plaintext highlighter-rouge">Options</code> icon at the top of Kontakt and navigate to <code class="language-plaintext highlighter-rouge">Engine</code>. There, you will want to modify <code class="language-plaintext highlighter-rouge">Send MIDI to outside world</code> to include <code class="language-plaintext highlighter-rouge">Script generated notes</code> and <code class="language-plaintext highlighter-rouge">script generated CCs</code>. Your options should appear as follows:</p>

    <p><img src="/assets/2022-10-15-how-to-create-a-kontakt-7-instrument-part-4/001.png" alt="kontakt panel with script generated notes selected" title="kontakt panel" /></p>
  </li>
  <li>
    <p>Additionally, I find it helpful in some situations to ensure that the MIDI channel of your Kontakt instrument is set to <code class="language-plaintext highlighter-rouge">Omni</code> as follows:</p>

    <p><img src="/assets/2022-10-15-how-to-create-a-kontakt-7-instrument-part-4/002.png" alt="kontakt panel with omni midi selected" title="kontakt midi settings" /></p>
  </li>
  <li>Within your DAW of choice, getting the DAW to recognize the midi data and route it properly involves specific settings.</li>
  <li>
    <p>Within Ableton Live, this is relatively easy. First, load Kontakt with your script onto a MIDI track. Second, load a MIDI instrument of your choosing into a second track. Finally, modify the track routing as follows:</p>

    <p><img src="/assets/2022-10-15-how-to-create-a-kontakt-7-instrument-part-4/003.png" alt="two ableton live tracks set to record monitoring midi" title="ableton live tracks" />
Notice that the left-hand track, which is currently assigned Kontakt with our script loaded, is set to monitor <code class="language-plaintext highlighter-rouge">All Ins</code>. <code class="language-plaintext highlighter-rouge">Monitor</code> is set to <code class="language-plaintext highlighter-rouge">In</code>. The right-hand track, assigned to a midi instrument of our choosing (I try to use a simple piano for development), is set to get <code class="language-plaintext highlighter-rouge">MIDI From</code> our first track. Both the top and bottom dropdowns are set to monitor the first track. Finally, and most importantly, in Ableton Live, both tracks are <code class="language-plaintext highlighter-rouge">record enabled</code>.</p>
  </li>
  <li>
    <p>If you are a Logic user, you will need to run Kontakt in the stand-alone application. With the stand-alone application running, with your script copied in, you will go to <code class="language-plaintext highlighter-rouge">Options &gt; MIDI &gt; Outputs</code> and ensure that <code class="language-plaintext highlighter-rouge">Kontakt X Virtual Instrument</code> is <code class="language-plaintext highlighter-rouge">on</code>. Once you have a virtual instrument loaded within Logic, it will <em>likely</em> play the resulting MIDI.</p>

    <p><img src="/assets/2022-10-15-how-to-create-a-kontakt-7-instrument-part-4/004.png" alt="kontakt panel with midi options selected" title="kontakt midi settings" /></p>
  </li>
</ul>

<h3 id="congratulations">Congratulations</h3>

<p>You have now worked with MIDI for the first time in your project. In our next iteration of this series, we will be adding further possibilities for midi generation.</p>

<p>Copyright © 2022 THI. All rights reserved. gelvinwhite.com is operated by THI.</p>

<p><em>Native Instruments®️ and Kontakt®️ are registered trademarks of Native Instruments GmbH. We have no affiliation with Native Instruments.</em></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/kontakt/2022/10/02/how-to-create-a-kontakt-7-instrument-part-3/">
        How to Create a Kontakt 7 Instrument (Part 3) - Switcheroo
      </a>
    </h1>

    <span class="post-date">02 Oct 2022</span>

    <p>Welcome to the third installment of my multi-part series about how to engage in the beautiful pursuit of building your own instruments, effects, and plugins in the Kontakt Script Processor (KSP).</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>This tutorial continues from the <a href="https://gelvinwhite.com/kontakt/2022/10/01/how-to-create-a-kontakt-7-instrument-part-2/">second installment</a> of this multi-part series. So, if you have not followed the instructions in our previous installments, best to backtrack and complete those steps. Further, this tutorial requires a full version of Kontakt. Likely, Kontakt 5 or later is fine. However, screenshots in this tutorial are of Kontakt 7.</p>

<h2 id="getting-started">Getting Started</h2>

<p>Continuing from where we left off, please ensure that the following starter code is in place in the scripting window:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```
{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $switch that is tied to a button. Set that switch to on }
  declare ui_switch $switch
  $switch := 1

end on

{this runs when the ui_control called $switch is changed}
on ui_control($switch)

  if($switch = 1)
    message("it's on!")
  else
    message("it's off!")
  end if
end on
```
</code></pre></div></div>

<p>Ensure that the script functions by clicking <code class="language-plaintext highlighter-rouge">Apply</code>. Upon clicking <code class="language-plaintext highlighter-rouge">Apply</code> followed by clicking <code class="language-plaintext highlighter-rouge">switch</code> you should see <code class="language-plaintext highlighter-rouge">it's on!</code> or <code class="language-plaintext highlighter-rouge">it's off!</code> appearing in the status bar / console at the bottom of the screen.</p>

<h3 id="step-one---buttons-and-more-buttons">Step One - Buttons and More Buttons</h3>

<ul>
  <li>
    <p>To begin, we will a series of buttons that interact with one another. First, let’s change our <code class="language-plaintext highlighter-rouge">switch</code> button to be called <code class="language-plaintext highlighter-rouge">run</code>. Modify your code as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $run that is tied to a button. Set that button to on }
  declare ui_switch $run
  $run := 1

end on

{this runs when the ui_control called $switch is changed}
on ui_control($run)

  if($run = 1)
    message("it's on!")
  else
    message("it's off!")
  end if
end on
</code></pre></div>    </div>
    <p>Notice that all references to <code class="language-plaintext highlighter-rouge">switch</code> have been changed to <code class="language-plaintext highlighter-rouge">run</code>, effectively renaming this button.</p>
  </li>
  <li>To ensure that your script is functioning, hit <code class="language-plaintext highlighter-rouge">Apply</code>. The code should function as it did prior.</li>
  <li>
    <p>Second, let’s add three other buttons as well. Modify your code as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $run that is tied to a button. Set that button to on }
  declare ui_switch $run
  $run := 1

  {declare another button called $option1 that is tied to a button. The initial value is set to on}
  declare ui_switch $option1
  $option1 := 1
  declare $option1Id
  $option1Id := get_ui_id($option1)
  set_control_par_str($option1Id, $CONTROL_PAR_TEXT, "A")

  {declare another button called $option2 that is tied to a button. The initial value is set to off}
  declare ui_switch $option2
  $option2 := 0
  declare $option2Id
  $option2Id := get_ui_id($option2)
  set_control_par_str($option2Id, $CONTROL_PAR_TEXT, "B")

  {declare another button called $option3 that is tied to a button. The initial value is set to off}
  declare ui_switch $option3
  $option3 := 0
  declare $option3Id
  $option3Id := get_ui_id($option3)
  set_control_par_str($option3Id, $CONTROL_PAR_TEXT, "C")

end on

{this runs when the ui_control called $switch is changed}
on ui_control($run)

  if($run = 1)
    message("it's on!")
  else
    message("it's off!")
  end if
end on
</code></pre></div>    </div>
  </li>
  <li>
    <p>Let’s dissect this code a bit. Notice that a new button is added with the following code:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{declare another button called $option1 that is tied to a button. The initial value is set to on}
declare ui_switch $option1
$option1 := 1
declare $option1Id
$option1Id := get_ui_id($option1)
set_control_par_str($option1Id, $CONTROL_PAR_TEXT, "A")
</code></pre></div>    </div>
    <p>Notice that the first line <code class="language-plaintext highlighter-rouge">declare ui_switch $option1</code> is the same code that created the <code class="language-plaintext highlighter-rouge">run</code> button, simply changed to address <code class="language-plaintext highlighter-rouge">option1</code>. Second, <code class="language-plaintext highlighter-rouge">$option1 := 1</code> sets the switch’s initial value to <code class="language-plaintext highlighter-rouge">1</code> or <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">on</code>. Next, <code class="language-plaintext highlighter-rouge">declare $option1Id</code> declares a new variable that we will use to keep track of the unique ID that the compiler will use to keep track of this new switch. Every switch will have a unique ID assigned to it by the compiler. The line <code class="language-plaintext highlighter-rouge">\$option1Id := get_ui_id(\$option1)</code> asks the compiler to tell us what the unique ID is for <code class="language-plaintext highlighter-rouge">$option1</code>. This value is stored in the <code class="language-plaintext highlighter-rouge">$option1Id</code> variable so it can be used later. The final line <code class="language-plaintext highlighter-rouge">set_control_par_str(\$option1Id, \$CONTROL_PAR_TEXT, "A")</code> simply tells the compiler what text should be displayed inside this switch. This code is repeated for both <code class="language-plaintext highlighter-rouge">$option2</code> and <code class="language-plaintext highlighter-rouge">$option3</code>, changing the values accordingly.</p>
  </li>
  <li>Make sure your code functions by clicking the <code class="language-plaintext highlighter-rouge">Apply</code> button and testing out the buttons.</li>
</ul>

<h3 id="step-two---toggle-time">Step Two - Toggle Time</h3>

<ul>
  <li>
    <p>It’s possible to make the buttons react to one another. From this point forward in the tutorial, I will refer to each button by the text that appears within them. In this case, we want to make it so <code class="language-plaintext highlighter-rouge">A</code>, <code class="language-plaintext highlighter-rouge">B</code>, and <code class="language-plaintext highlighter-rouge">C</code> cannot be selected at the same time. For example, if <code class="language-plaintext highlighter-rouge">B</code> is selected, <code class="language-plaintext highlighter-rouge">A</code> and <code class="language-plaintext highlighter-rouge">C</code> should automatically turn themselves to the off position. This can be accomplished through the <code class="language-plaintext highlighter-rouge">on ui_control</code> callback. Modify your code as follows. Specifically, notice the new callbacks added to the end of the code:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $run that is tied to a button. Set that button to on }
  declare ui_switch $run
  $run := 1

  {declare another button called $option1 that is tied to a button. The initial value is set to on}
  declare ui_switch $option1
  $option1 := 1
  declare $option1Id
  $option1Id := get_ui_id($option1)
  set_control_par_str($option1Id, $CONTROL_PAR_TEXT, "A")

  {declare another button called $option2 that is tied to a button. The initial value is set to off}
  declare ui_switch $option2
  $option2 := 0
  declare $option2Id
  $option2Id := get_ui_id($option2)
  set_control_par_str($option2Id, $CONTROL_PAR_TEXT, "B")

  {declare another button called $option3 that is tied to a button. The initial value is set to off}
  declare ui_switch $option3
  $option3 := 0
  declare $option3Id
  $option3Id := get_ui_id($option3)
  set_control_par_str($option3Id, $CONTROL_PAR_TEXT, "C")

end on

{this runs when the ui_control called $switch is changed}
on ui_control($run)

  if($run = 1)
    message("it's on!")
  else
    message("it's off!")
  end if
end on

{this runs when the ui_control called $option1 is changed}
on ui_control ($option1)

  $option1 := 1

  {toggle the other buttons off}
  $option2 := 0
  $option3 := 0

end on

{this runs when the ui_control called $option2 is changed}
on ui_control ($option2)

  $option2 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option3 := 0

end on

{this runs when the ui_control called $option3 is changed}
on ui_control ($option3)

  $option3 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option2 := 0

end on
</code></pre></div>    </div>
    <p>Notice how applying the above code will result in only one of the three <code class="language-plaintext highlighter-rouge">A</code>, <code class="language-plaintext highlighter-rouge">B</code>, <code class="language-plaintext highlighter-rouge">C</code> buttons being on at a time.</p>
  </li>
  <li>
    <p>So we can better understand what’s happening, let’s turn our attention to each of the new callbacks for <code class="language-plaintext highlighter-rouge">on ui_control</code>:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  {this runs when the ui_control called $option1 is changed}
  on ui_control ($option1)

    $option1 := 1

    {toggle the other buttons off}
    $option2 := 0
    $option3 := 0

  end on
</code></pre></div>    </div>
    <p>When the above code is executed, <code class="language-plaintext highlighter-rouge">$option1</code> is set to the on position. Next, all the other buttons are set to <code class="language-plaintext highlighter-rouge">0</code> or the off position. The same logic is employed with the other buttons.</p>
  </li>
</ul>

<h3 id="step-three---the-state-of-things">Step Three - The State of Things</h3>

<ul>
  <li>Now, all of our buttons are in place for our first Kontakt instrument. We are almost to the point where our script can start doing things musically interesting. To prepare for musical magic, we have some final edits to complete.</li>
  <li>
    <p>First, let’s modify the initial value of <code class="language-plaintext highlighter-rouge">$run</code>. Up until this point, by default it has been set to the <code class="language-plaintext highlighter-rouge">on</code> position. Modify your code in <code class="language-plaintext highlighter-rouge">on init</code> as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$run := 0
</code></pre></div>    </div>
    <p>Notice how where it was prior set to <code class="language-plaintext highlighter-rouge">1</code>, we have changed it to <code class="language-plaintext highlighter-rouge">0</code>.</p>
  </li>
  <li>
    <p>Second, let’s create a new variable, a string, called <code class="language-plaintext highlighter-rouge">@state</code> in our <code class="language-plaintext highlighter-rouge">on init</code> callback. We will use this string to keep track of which of our <code class="language-plaintext highlighter-rouge">A</code> <code class="language-plaintext highlighter-rouge">B</code> <code class="language-plaintext highlighter-rouge">C</code> buttons is set to the on position:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{set initial instrument state value}
declare @state
@state := "A"
</code></pre></div>    </div>
  </li>
  <li>
    <p>Third, in each of our <code class="language-plaintext highlighter-rouge">on ui_control ($option)</code> callbacks, we will add a line that sets the state for that callback. For example, for <code class="language-plaintext highlighter-rouge">on ui_control ($option1)</code> we will modify the <code class="language-plaintext highlighter-rouge">@state</code> variable as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this runs when the ui_control called $option1 is changed}
on ui_control ($option1)

  $option1 := 1

  {toggle the other buttons off}
  $option2 := 0
  $option3 := 0

  @state := "A"

end on
</code></pre></div>    </div>
  </li>
  <li>
    <p>Fourth, let’s make it so the <code class="language-plaintext highlighter-rouge">run</code> button is set to <code class="language-plaintext highlighter-rouge">off</code> every time the <code class="language-plaintext highlighter-rouge">A</code>, <code class="language-plaintext highlighter-rouge">B</code> or <code class="language-plaintext highlighter-rouge">C</code> option is changed. In each of our <code class="language-plaintext highlighter-rouge">on ui_control($option)</code> callbacks, we will add another line that turns off <code class="language-plaintext highlighter-rouge">run</code>. For example, for <code class="language-plaintext highlighter-rouge">on ui_control ($option1)</code> we will modify the code as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this runs when the ui_control called $option1 is changed}
on ui_control ($option1)

  $option1 := 1

  {toggle the other buttons off}
  $option2 := 0
  $option3 := 0

  {reset the run button}
  $run := 0
  message("Ready to run")

  @state := "A"

end on
</code></pre></div>    </div>
  </li>
  <li>
    <p>Finally, we will modify the <code class="language-plaintext highlighter-rouge">on ui_control($run)</code> callback as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this runs when the ui_control called $switch is changed}
on ui_control($run)

  if($run = 1)
    message("Running " &amp; @state)
  else
    message("Ready to run")
  end if
end on
</code></pre></div>    </div>
    <p>Notice that when the <code class="language-plaintext highlighter-rouge">run</code> button is pressed, it places a message in the console that echos the state that is running, whether <code class="language-plaintext highlighter-rouge">A</code>, <code class="language-plaintext highlighter-rouge">B</code>, or <code class="language-plaintext highlighter-rouge">C</code>. Otherwise, the console messages <code class="language-plaintext highlighter-rouge">Ready to run</code>.</p>
  </li>
  <li>
    <p>A measure of consistency, let’s add a <code class="language-plaintext highlighter-rouge">message("Ready to run")</code> in the <code class="language-plaintext highlighter-rouge">on init</code> function such that there is always something displaying in the console. Notice how the console provides us important feedback as the programmer, such that we can understand what’s happening inside of our program. Your final code for this step should be the following:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $run that is tied to a button. Set that button to off }
  declare ui_switch $run
  $run := 0
  message("Ready to run")

  {declare another button called $option1 that is tied to a button. The initial value is set to on}
  declare ui_switch $option1
  $option1 := 1
  declare $option1Id
  $option1Id := get_ui_id($option1)
  set_control_par_str($option1Id, $CONTROL_PAR_TEXT, "A")

  {declare another button called $option2 that is tied to a button. The initial value is set to off}
  declare ui_switch $option2
  $option2 := 0
  declare $option2Id
  $option2Id := get_ui_id($option2)
  set_control_par_str($option2Id, $CONTROL_PAR_TEXT, "B")

  {declare another button called $option3 that is tied to a button. The initial value is set to off}
  declare ui_switch $option3
  $option3 := 0
  declare $option3Id
  $option3Id := get_ui_id($option3)
  set_control_par_str($option3Id, $CONTROL_PAR_TEXT, "C")

  {set initial instrument state value}
  declare @state
  @state := "A"

end on

{this runs when the ui_control called $switch is changed}
on ui_control($run)

  if($run = 1)
    message("Running " &amp; @state)
  else
    message("Ready to run")
  end if
end on

{this runs when the ui_control called $option1 is changed}
on ui_control ($option1)

  $option1 := 1

  {toggle the other buttons off}
  $option2 := 0
  $option3 := 0

  {reset the run button}
  $run := 0
  message("Ready to run")

  @state := "A"

end on

{this runs when the ui_control called $option2 is changed}
on ui_control ($option2)

  $option2 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option3 := 0

  {reset the run button}
  $run := 0
  message("Ready to run")

  @state := "B"

end on

{this runs when the ui_control called $option3 is changed}
on ui_control ($option3)

  $option3 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option2 := 0

  {reset the run button}
  $run := 0
  message("Ready to run")

  @state := "C"

end on
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="step-four---your-first-function">Step Four - Your First Function</h3>

<ul>
  <li>
    <p>Functions are callbacks of your own design. Functions can be useful in executing blocks of code at will – especially those that are repeated throughout your code. Notice how a specific block of code tends to repeat over and over again:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$run := 0
message("Ready to run")
</code></pre></div>    </div>
    <p>This code appears in no less than four places currently.</p>
  </li>
  <li>
    <p>It’s generally considered bad design to repeat the same code time and time again where a line of code could be employed in place of the repeats. Immediately after the <code class="language-plaintext highlighter-rouge">on init</code> callback, after <code class="language-plaintext highlighter-rouge">end on</code>, add the following:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{creates a function that resets the values of run}
function resetRun()

  $run := 0
  message("Ready to run")

end function
</code></pre></div>    </div>
  </li>
  <li>
    <p>Further, in the three places in the <code class="language-plaintext highlighter-rouge">on ui_control</code> for <code class="language-plaintext highlighter-rouge">$option1</code>, <code class="language-plaintext highlighter-rouge">$option2</code>, and <code class="language-plaintext highlighter-rouge">$option3</code>, replace the two lines that reset the <code class="language-plaintext highlighter-rouge">$run</code> variable and messages <code class="language-plaintext highlighter-rouge">Ready to run</code> to <code class="language-plaintext highlighter-rouge">call resetRun()</code>. Sadly, we cannot utilize such functions in <code class="language-plaintext highlighter-rouge">on init</code> – which makes me sad as a programmer. In the end, your final code should appear as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this always runs when the script starts}
on init

  {set the basics of the UI, setting the height at 213 and width at 720}
  make_perfview
  set_ui_height_px(213)
  set_ui_width_px(633)

  {declare a variable called $run that is tied to a button. Set that button to off }
  declare ui_switch $run
  $run := 0
  message("Ready to run")

  {declare another button called $option1 that is tied to a button. The initial value is set to on}
  declare ui_switch $option1
  $option1 := 1
  declare $option1Id
  $option1Id := get_ui_id($option1)
  set_control_par_str($option1Id, $CONTROL_PAR_TEXT, "A")

  {declare another button called $option2 that is tied to a button. The initial value is set to off}
  declare ui_switch $option2
  $option2 := 0
  declare $option2Id
  $option2Id := get_ui_id($option2)
  set_control_par_str($option2Id, $CONTROL_PAR_TEXT, "B")

  {declare another button called $option3 that is tied to a button. The initial value is set to off}
  declare ui_switch $option3
  $option3 := 0
  declare $option3Id
  $option3Id := get_ui_id($option3)
  set_control_par_str($option3Id, $CONTROL_PAR_TEXT, "C")

  {set initial instrument state value}
  declare @state
  @state := "A"

end on

{creates a function that resets the values of run}
function resetRun()

  $run := 0
  message("Ready to run")

end function

{this runs when the ui_control called $switch is changed}
on ui_control($run)

  if($run = 1)
    message("Running " &amp; @state)
  else
    message("Ready to run")
  end if
end on

{this runs when the ui_control called $option1 is changed}
on ui_control ($option1)

  $option1 := 1

  {toggle the other buttons off}
  $option2 := 0
  $option3 := 0

  {reset the run button}
  call resetRun()

  @state := "A"

end on

{this runs when the ui_control called $option2 is changed}
on ui_control ($option2)

  $option2 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option3 := 0

  {reset the run button}
  call resetRun()

  @state := "B"

end on

{this runs when the ui_control called $option3 is changed}
on ui_control ($option3)

  $option3 := 1

  {toggle the other buttons off}
  $option1 := 0
  $option2 := 0

  {reset the run button}
  call resetRun()

  @state := "C"

end on
</code></pre></div>    </div>
    <p>Notice how the function called <code class="language-plaintext highlighter-rouge">resetRun</code> must appear above those callbacks that utilize this function. Through the utilization of this function, we are <em>abstracting away</em>, or simplifying, our code by taking a task that took six lines of code and reducing it down to a single line of code. Abstraction of this nature will become of particular importance as you develop as a KSP developer.</p>
  </li>
</ul>

<h3 id="congratulations">Congratulations</h3>

<p>You have now finalized the physical interface of your first Kontakt instrument. It could be tempting to get lured in by graphical interfaces, prototyping backgrounds and button layouts in specialized software. However, my recommendation is to keep things simple for the time being. Focus on function over aesthetics for a short while.</p>

<p>The tutorial to follow will allow you to <em>finally</em> produce something musically interesting.</p>

<p>Copyright © 2022 THI. All rights reserved. gelvinwhite.com is operated by THI.</p>

<p><em>Native Instruments®️ and Kontakt®️ are registered trademarks of Native Instruments GmbH. We have no affiliation with Native Instruments.</em></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/kontakt/2022/10/01/how-to-create-a-kontakt-7-instrument-part-2/">
        How to Create a Kontakt 7 Instrument (Part 2) - Push It!
      </a>
    </h1>

    <span class="post-date">01 Oct 2022</span>

    <p>Welcome to the second installment of my multi-part series about how to engage in the beautiful pursuit of building your own instruments, effects, and plugins in the Kontakt Script Language.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>This tutorial continues from the <a href="https://gelvinwhite.com/kontakt/2022/09/30/how-to-create-a-kontakt-7-instrument/">first installment</a> of this multi-part series. So, if you have not followed the instructions there, best to backtrack and complete those steps. Further, this tutorial requires a full version of Kontakt. Likely, Kontakt 5 or later is fine. However, screenshots in this tutorial are of Kontakt 7.</p>

<h2 id="getting-started">Getting Started</h2>

<p>Continuing from where we left off, please ensure that the following starter code is in place in the scripting window:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```
on init

  message("Hello World!")

end on
```
</code></pre></div></div>

<p>Ensure that the script functions by clicking <code class="language-plaintext highlighter-rouge">Apply</code>. Upon clicking <code class="language-plaintext highlighter-rouge">Apply</code>, you should see <code class="language-plaintext highlighter-rouge">Hello World!</code> appearing in the status bar / console at the bottom of the screen.</p>

<h3 id="step-one---creating-the-performance-view">Step One - Creating the Performance View</h3>

<ul>
  <li>
    <p>To begin, we will create the <em>performance view</em> of the instrument. You can think of the performance view as the canvas upon which your buttons, dials, and other graphical elements will appear when someone is using the instrument. Modify your code as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>on init

  {set the basics of the UI, setting the height at 213 and width at 720}
	make_perfview
	set_ui_height_px(213)
	set_ui_width_px(633)

end on
</code></pre></div>    </div>
    <p>Notice that <code class="language-plaintext highlighter-rouge">make_perfview</code> informs the compiler that there is a user interface that needs to be rendered to the user, even when they are not in the script editor. Without this line of code, your user interface will not be visible. Then, <code class="language-plaintext highlighter-rouge">set_ui_height_px</code> and <code class="language-plaintext highlighter-rouge">set_ui_width_px</code> tell the compiler the size of the performance view.</p>

    <p>Most important, notice the curly <code class="language-plaintext highlighter-rouge">{}</code> braces, which allows you to comment your code. Throughout your process of learning how to program, I highly advise keeping good notes about what your code does! After all, when you return later in a week, month, or year, it’s helpful to know what your code is doing.</p>
  </li>
  <li>
    <p>To ensure that your script is functioning, hit <code class="language-plaintext highlighter-rouge">apply</code>. Then, click the wrench icon to switch to performance view. Your window should look like this:</p>

    <p><img src="/assets/2022-10-02-how-to-create-a-kontakt-7-instrument-part-2/001.png" alt="kontakt wrench" title="kontakt wrench" />
Note that if your screen does not look like the above, you probably did not click that wrench.</p>
  </li>
</ul>

<h3 id="step-two---placing-your-first-button">Step Two - Placing Your First Button</h3>

<ul>
  <li>
    <p>Next, let’s place your first button. Modify your code as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>on init

	{set the basics of the UI, setting the height at 213 and width at 720}
	make_perfview
	set_ui_height_px(213)
	set_ui_width_px(633)

	{declare a variable called $switch that is tied to a button. Set that switch to on }
	declare ui_switch $switch
	$switch := 1

	message("Hello World!")

end on
</code></pre></div>    </div>
    <p>Notice that the <code class="language-plaintext highlighter-rouge">declare</code> command is used to create a variable called <code class="language-plaintext highlighter-rouge">switch</code>. This variable has a <code class="language-plaintext highlighter-rouge">$</code> sign in front of it, which tells us that this variable is an integer. Further, this variable called <code class="language-plaintext highlighter-rouge">switch</code> is tied to a button, signified by <code class="language-plaintext highlighter-rouge">ui_switch</code>. Then <code class="language-plaintext highlighter-rouge">$switch</code> is set to <code class="language-plaintext highlighter-rouge">1</code>. When a <code class="language-plaintext highlighter-rouge">ui_switch</code> has a value of <code class="language-plaintext highlighter-rouge">0</code> it is off. When it is <code class="language-plaintext highlighter-rouge">1</code> it is on.</p>
  </li>
  <li>
    <p>Now, click the <code class="language-plaintext highlighter-rouge">Apply</code> button.</p>
  </li>
  <li>
    <p>Upon clicking <code class="language-plaintext highlighter-rouge">Apply</code>, you should see the following:</p>

    <p><img src="/assets/2022-10-02-how-to-create-a-kontakt-7-instrument-part-2/002.png" alt="kontakt switch" title="kontakt switch" /></p>
  </li>
  <li>
    <p>Click on the button called <code class="language-plaintext highlighter-rouge">switch</code>. You’ll notice that in the <em>on</em> position it is lighter in color. In the <em>off</em> position, it is darker in color</p>
  </li>
</ul>

<h3 id="step-three---making-the-button-interactive">Step Three - Making the Button Interactive</h3>

<ul>
  <li>
    <p>Now, it’s time to learn a little about <em>callbacks</em>. A callback is a block of code that is executed at a specific time. For example, the <code class="language-plaintext highlighter-rouge">on init</code> callback is run each time the script is run. This callback is the first callback to be run, always. You can create multiple callbacks in your program. Modify your code as follows:</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{this always runs when the script starts}
on init

	{set the basics of the UI, setting the height at 213 and width at 720}
	make_perfview
	set_ui_height_px(213)
	set_ui_width_px(633)

	{declare a variable called $switch that is tied to a button. Set that switch to on }
	declare ui_switch $switch
	$switch := 1

end on

{this runs when the ui_control called $switch is changed}
on ui_control($switch)

  if($switch = 1)
    message("it's on!")
  else
    message("it's off!")
  end if
end on
</code></pre></div>    </div>
    <p>Notice that a new callback called <code class="language-plaintext highlighter-rouge">ui_control($switch)</code> is included. When <code class="language-plaintext highlighter-rouge">$switch1</code> is manipulated, this callback is called. Notice that the value of <code class="language-plaintext highlighter-rouge">$switch1</code> is passed to this callback using the <code class="language-plaintext highlighter-rouge">()</code> parentheses. Then, inside the callback, the <code class="language-plaintext highlighter-rouge">if</code> statement makes a decision. If <code class="language-plaintext highlighter-rouge">$switch = 1</code> or <em>on</em>, then <code class="language-plaintext highlighter-rouge">it's on!</code> is messaged in the console. Otherwise, <code class="language-plaintext highlighter-rouge">it's off</code> is messaged.</p>
  </li>
  <li>
    <p>Click “Apply” and play with the button. Notice what is displayed in the console.</p>

    <p><img src="/assets/2022-10-02-how-to-create-a-kontakt-7-instrument-part-2/003.png" alt="kontakt console" title="kontakt console" /></p>
  </li>
</ul>

<h3 id="congratulations">Congratulations</h3>

<p>You have now created your first interactive button!</p>

<p>The tutorial to follow will discuss the placement of buttons within the performance view.</p>

<p>Copyright © 2022 THI. All rights reserved. gelvinwhite.com is operated by THI.</p>

<p><em>Native Instruments®️ and Kontakt®️ are registered trademarks of Native Instruments GmbH. We have no affiliation with Native Instruments.</em></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/kontakt/2022/09/30/how-to-create-a-kontakt-7-instrument/">
        How to Create a Kontakt 7 Instrument (Part 1) - Hello World!
      </a>
    </h1>

    <span class="post-date">30 Sep 2022</span>

    <p>Welcome to the beautiful pursuit of building your own instruments, effects, and plugins in the Kontakt Script Processor (KSP).</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>This tutorial requires a full version of Kontakt. Likely, Kontakt 5 or later is fine. However, screenshots in this tutorial are of Kontakt 7.</p>

<h2 id="getting-started">Getting Started</h2>

<p>The Kontakt Script Processor language is a well-documented programming language with a thriving community behind it. As you get started, I recommend getting your hands on the following resources:</p>

<ul>
  <li>Obtain the <a href="https://www.native-instruments.com/forum/attachments/kontakt-script-language-pdf.86897/">Kontakt Script Language</a> development document. Ignore the age of this document or any references to Kontakt version numbers. It is masterfully written document that is exceedingly applicable today. This document provides a narrative introduction to the scripting language.</li>
  <li>Obtain the <a href="https://www.native-instruments.com/fileadmin/ni_media/downloads/manuals/kontakt/KONTAKT_602_KSP_Reference_Manual.pdf">KSP Reference Manual</a>. As of time of this writing, the KSP Reference Manual discusses Kontakt 6. This is not a problem!</li>
  <li>Join the <a href="https://www.native-instruments.com/en/community/">Native Instruments Community</a>.</li>
  <li>Join the <a href="https://discord.com/invite/rTpCcpg">NI Kontakt Discord</a></li>
</ul>

<h3 id="step-one---find-the-scripting-environment">Step One - Find the Scripting Environment.</h3>

<ul>
  <li>
    <p>Open your full version of Kontakt. Likely, you will see a screen like this:</p>

    <p><img src="/assets/2022-10-01-how-to-create-a-kontakt-7-instrument/001.png" alt="kontakt splash screen with many libraries" title="kontakt splash screen" /></p>
  </li>
  <li>
    <p>Next, click the file icon and then select <code class="language-plaintext highlighter-rouge">New instrument</code>.</p>

    <p><img src="/assets/2022-10-01-how-to-create-a-kontakt-7-instrument/002.png" alt="kontakt splash screen with menu open creating new instrument" title="kontakt new instrument" /></p>
  </li>
  <li>
    <p>Next, click the wrench <code class="language-plaintext highlighter-rouge">edit mode</code> icon.</p>

    <p><img src="/assets/2022-10-01-how-to-create-a-kontakt-7-instrument/003.png" alt="kontakt interface with the wrench" title="kontakt edit mode" /></p>
  </li>
  <li>
    <p>Next, click the <code class="language-plaintext highlighter-rouge">Script Editor</code> button.</p>

    <p><img src="/assets/2022-10-01-how-to-create-a-kontakt-7-instrument/004.png" alt="kontakt opening script editor" title="kontakt opening script editor" /></p>
  </li>
  <li>
    <p>Finally, click the <code class="language-plaintext highlighter-rouge">Edit</code> button.</p>

    <p><img src="/assets/2022-10-01-how-to-create-a-kontakt-7-instrument/005.png" alt="kontakt edit button" title="kontakt edit button" /></p>
  </li>
  <li>
    <p>You are now in the Script Editor. Congrats!</p>

    <p><img src="/assets/2022-10-01-how-to-create-a-kontakt-7-instrument/006.png" alt="kontakt script editor" title="kontakt script editor" /></p>
  </li>
</ul>

<h3 id="step-two---hello-world">Step Two - Hello World!</h3>

<ul>
  <li>Copy and paste the following code into the Script Editor window.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  on init

  	message("Hello World!")

  end on
</code></pre></div></div>

<ul>
  <li>
    <p>Now, click the <code class="language-plaintext highlighter-rouge">Apply</code> button.</p>
  </li>
  <li>
    <p>Upon clicking <code class="language-plaintext highlighter-rouge">Apply</code>, you should see <code class="language-plaintext highlighter-rouge">Hello World!</code> appearing in the status bar / console at the bottom of the screen.</p>

    <p><img src="/assets/2022-10-01-how-to-create-a-kontakt-7-instrument/007.png" alt="kontakt hello world" title="kontakt hello world" /></p>
  </li>
</ul>

<h3 id="step-three---analyzing-the-script">Step Three - Analyzing the Script</h3>

<p>The block of code from <code class="language-plaintext highlighter-rouge">on init</code> to <code class="language-plaintext highlighter-rouge">end on</code> is always run first by the script compiler. Anything that you put in this block of code will run!</p>

<p>The <code class="language-plaintext highlighter-rouge">message("Hello World!")</code> statement tells the compiler to output <code class="language-plaintext highlighter-rouge">Hello World!</code> into the console. You can change this message within the quotes to say anything you like. In future projects, you will find it exceptionally useful to be able to output to the console – such that you can provide yourself clues about what is happening in your code. This <code class="language-plaintext highlighter-rouge">message</code> function will be an invaluable tool you will use in the future to catch and understand bugs in your script.</p>

<h3 id="congratulations">Congratulations</h3>

<p>You have now created your first Kontakt script!</p>

<p>The tutorial to follow will discuss adding buttons to your interface.</p>

<p>Copyright © 2022 THI. All rights reserved. gelvinwhite.com is operated by THI.</p>

<p><em>Native Instruments®️ and Kontakt®️ are registered trademarks of Native Instruments GmbH. We have no affiliation with Native Instruments.</em></p>

  </div>
  
</div>

<div class="pagination">
  
    <span class="pagination-item older">Older</span>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>
-->

    </div>

  </body>
</html>
